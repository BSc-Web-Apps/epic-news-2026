import{j as e,w as F,f as P,r as y,F as N}from"./chunk-UH6JLGW7-vC5r3Eub.js";import{E as h}from"./forms-D7XpjJLD.js";import{B as g}from"./button-BP3wkmPp.js";import{I as n}from"./icon-C3K2m46L.js";import{S as f}from"./status-button-hfmu5Em_.js";import{a as C,b as R,g as w}from"./misc-CB38qpgG.js";import{u as B,g as T,a as E}from"./helpers-Ch5Ym2hM.js";import{g as z}from"./constraint-cuuFo8uo.js";import{p as k}from"./parse-Bbiqquwr.js";import{o as j,l as b,i as A,d as U}from"./types-kDhgxygl.js";import"./index-Bn1b60ek.js";import"./index-C2xojAqc.js";import"./index-BlK1szso.js";import"./dom--0h4o3Zv.js";import"./tooltip-fkOurSWR.js";const se={breadcrumb:e.jsx(n,{name:"avatar",children:"Photo"}),getSitemapEntries:()=>null},Z=1024*1024*3,q=j({intent:b("delete")}),D=j({intent:b("submit"),photoFile:A(File).refine(i=>i.size>0,"Image is required").refine(i=>i.size<=Z,"Image size must be less than 3MB")}),x=U("intent",[q,D]),re=F(function({loaderData:t,actionData:v}){const a=C(),I=P(),[s,r]=B({id:"profile-photo",constraint:z(x),lastResult:v?.result,onValidate({formData:o}){return k(o,{schema:x})},shouldRevalidate:"onBlur"}),l=R()?I.formData?.get("intent"):null,m=r.intent.value,[u,c]=y.useState(null);return e.jsx("div",{children:e.jsxs(N,{method:"POST",encType:"multipart/form-data",className:"flex flex-col items-center justify-center gap-10",onReset:()=>c(null),...T(s),children:[e.jsx("img",{src:u??(t.user?w(t.user.image?.objectKey):""),className:"size-52 rounded-full object-cover",alt:t.user?.name??t.user?.username}),e.jsx(h,{errors:r.photoFile.errors,id:r.photoFile.id}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{...E(r.photoFile,{type:"file"}),accept:"image/*",className:"peer sr-only",required:!0,tabIndex:u?-1:0,onChange:o=>{const d=o.currentTarget.files?.[0];if(d){const p=new FileReader;p.onload=S=>{c(S.target?.result?.toString()??null)},p.readAsDataURL(d)}}}),e.jsx(g,{asChild:!0,className:"cursor-pointer peer-valid:hidden peer-focus-within:ring-2 peer-focus-visible:ring-2",children:e.jsx("label",{htmlFor:r.photoFile.id,children:e.jsx(n,{name:"pencil-1",children:"Change"})})}),e.jsx(f,{name:"intent",value:"submit",type:"submit",className:"peer-invalid:hidden",status:l==="submit"?"pending":m==="submit"?s.status??"idle":"idle",children:"Save Photo"}),e.jsx(g,{variant:"destructive",className:"peer-invalid:hidden",...s.reset.getButtonProps(),children:e.jsx(n,{name:"trash",children:"Reset"})}),t.user.image?e.jsx(f,{className:"peer-valid:hidden",variant:"destructive",...a.getButtonProps({type:"submit",name:"intent",value:"delete"}),status:l==="delete"?"pending":m==="delete"?s.status??"idle":"idle",children:e.jsx(n,{name:"trash",children:a.doubleCheck?"Are you sure?":"Delete"})}):null]}),e.jsx(h,{errors:s.errors})]})})});export{re as default,se as handle};
//# sourceMappingURL=profile.photo-D1W9EI39.js.map
