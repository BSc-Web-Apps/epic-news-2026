{"version":3,"file":"profile.two-factor.disable-C4oSC-1L.js","sources":["../../../app/routes/settings+/profile.two-factor.disable.tsx"],"sourcesContent":["import { type SEOHandle } from '@nasa-gcn/remix-seo'\nimport { useFetcher } from 'react-router'\nimport { Icon } from '#app/components/ui/icon.tsx'\nimport { StatusButton } from '#app/components/ui/status-button.tsx'\nimport { requireRecentVerification } from '#app/routes/_auth+/verify.server.ts'\nimport { requireUserId } from '#app/utils/auth.server.ts'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { useDoubleCheck } from '#app/utils/misc.tsx'\nimport { redirectWithToast } from '#app/utils/toast.server.ts'\nimport { type Route } from './+types/profile.two-factor.disable.ts'\nimport { type BreadcrumbHandle } from './profile.tsx'\nimport { twoFAVerificationType } from './profile.two-factor.tsx'\n\nexport const handle: BreadcrumbHandle & SEOHandle = {\n\tbreadcrumb: <Icon name=\"lock-open-1\">Disable</Icon>,\n\tgetSitemapEntries: () => null,\n}\n\nexport async function loader({ request }: Route.LoaderArgs) {\n\tawait requireRecentVerification(request)\n\treturn {}\n}\n\nexport async function action({ request }: Route.ActionArgs) {\n\tawait requireRecentVerification(request)\n\tconst userId = await requireUserId(request)\n\tawait prisma.verification.delete({\n\t\twhere: { target_type: { target: userId, type: twoFAVerificationType } },\n\t})\n\treturn redirectWithToast('/settings/profile/two-factor', {\n\t\ttitle: '2FA Disabled',\n\t\tdescription: 'Two factor authentication has been disabled.',\n\t})\n}\n\nexport default function TwoFactorDisableRoute() {\n\tconst disable2FAFetcher = useFetcher<typeof action>()\n\tconst dc = useDoubleCheck()\n\n\treturn (\n\t\t<div className=\"mx-auto max-w-sm\">\n\t\t\t<disable2FAFetcher.Form method=\"POST\">\n\t\t\t\t<p>\n\t\t\t\t\tDisabling two factor authentication is not recommended. However, if\n\t\t\t\t\tyou would like to do so, click here:\n\t\t\t\t</p>\n\t\t\t\t<StatusButton\n\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\tstatus={disable2FAFetcher.state === 'loading' ? 'pending' : 'idle'}\n\t\t\t\t\t{...dc.getButtonProps({\n\t\t\t\t\t\tclassName: 'mx-auto',\n\t\t\t\t\t\tname: 'intent',\n\t\t\t\t\t\tvalue: 'disable',\n\t\t\t\t\t\ttype: 'submit',\n\t\t\t\t\t})}\n\t\t\t\t>\n\t\t\t\t\t{dc.doubleCheck ? 'Are you sure?' : 'Disable 2FA'}\n\t\t\t\t</StatusButton>\n\t\t\t</disable2FAFetcher.Form>\n\t\t</div>\n\t)\n}\n"],"names":["handle","breadcrumb","jsx","Icon","name","children","getSitemapEntries","profile_twoFactor_disable","_UNSAFE_withComponentProps","disable2FAFetcher","useFetcher","dc","useDoubleCheck","className","Form","method","StatusButton","variant","status","state","getButtonProps","value","type","doubleCheck"],"mappings":"4UAaO,MAAMA,EAAuC,CACnDC,WAAYC,EAAAA,IAACC,EAAA,CAAKC,KAAK,cAAcC,SAAA,SAAA,CAAO,EAC5CC,kBAAmBA,IAAM,IAC1B,EAmBAC,EAAAC,EAAA,UAAgD,CAC/C,MAAMC,EAAoBC,EAAA,EACpBC,EAAKC,EAAA,EAEX,OACCV,EAAAA,IAAC,OAAIW,UAAU,mBACdR,gBAACI,EAAkBK,KAAlB,CAAuBC,OAAO,OAC9BV,SAAA,CAAAH,EAAAA,IAAC,KAAEG,SAAA,0GAAA,CAGH,EACAH,EAAAA,IAACc,EAAA,CACAC,QAAQ,cACRC,OAAQT,EAAkBU,QAAU,UAAY,UAAY,OAC3D,GAAGR,EAAGS,eAAe,CACrBP,UAAW,UACXT,KAAM,SACNiB,MAAO,UACPC,KAAM,QACP,CAAC,EAEAjB,SAAAM,EAAGY,YAAc,gBAAkB,aAAA,CACrC,CAAA,EACD,CAAA,CACD,CAEF,CAAA"}