{"version":3,"file":"_username-Dv-F-OhR.js","sources":["../../../app/routes/users+/$username.tsx"],"sourcesContent":["import { invariantResponse } from '@epic-web/invariant'\nimport { Img } from 'openimg/react'\nimport {\n\ttype LoaderFunctionArgs,\n\tForm,\n\tLink,\n\tuseLoaderData,\n} from 'react-router'\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx'\nimport { Spacer } from '#app/components/spacer.tsx'\nimport { Button } from '#app/components/ui/button.tsx'\nimport { Icon } from '#app/components/ui/icon.tsx'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { getUserImgSrc } from '#app/utils/misc.tsx'\nimport { useOptionalUser } from '#app/utils/user.ts'\nimport { type Route } from './+types/$username.ts'\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n\tconst user = await prisma.user.findFirst({\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tname: true,\n\t\t\tusername: true,\n\t\t\tcreatedAt: true,\n\t\t\timage: { select: { id: true, objectKey: true } },\n\t\t},\n\t\twhere: {\n\t\t\tusername: params.username,\n\t\t},\n\t})\n\n\tinvariantResponse(user, 'User not found', { status: 404 })\n\n\treturn { user, userJoinedDisplay: user.createdAt.toLocaleDateString() }\n}\n\nexport default function ProfileRoute() {\n\tconst data = useLoaderData<typeof loader>()\n\tconst user = data.user\n\tconst userDisplayName = user.name ?? user.username\n\tconst loggedInUser = useOptionalUser()\n\tconst isLoggedInUser = user.id === loggedInUser?.id\n\n\treturn (\n\t\t<div className=\"container mt-36 mb-48 flex flex-col items-center justify-center\">\n\t\t\t<Spacer size=\"4xs\" />\n\n\t\t\t<div className=\"bg-muted container flex flex-col items-center rounded-3xl p-12\">\n\t\t\t\t<div className=\"relative w-52\">\n\t\t\t\t\t<div className=\"absolute -top-40\">\n\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t<Img\n\t\t\t\t\t\t\t\tsrc={getUserImgSrc(data.user.image?.objectKey)}\n\t\t\t\t\t\t\t\talt={userDisplayName}\n\t\t\t\t\t\t\t\tclassName=\"size-52 rounded-full object-cover\"\n\t\t\t\t\t\t\t\twidth={832}\n\t\t\t\t\t\t\t\theight={832}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<Spacer size=\"sm\" />\n\n\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t<div className=\"flex flex-wrap items-center justify-center gap-4\">\n\t\t\t\t\t\t<h1 className=\"text-h2 text-center\">{userDisplayName}</h1>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p className=\"text-muted-foreground mt-2 text-center\">\n\t\t\t\t\t\tJoined {data.userJoinedDisplay}\n\t\t\t\t\t</p>\n\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t<Form action=\"/logout\" method=\"POST\" className=\"mt-3\">\n\t\t\t\t\t\t\t<Button type=\"submit\" variant=\"link\" size=\"pill\">\n\t\t\t\t\t\t\t\t<Icon name=\"exit\" className=\"scale-125 max-md:scale-150\">\n\t\t\t\t\t\t\t\t\tLogout\n\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Form>\n\t\t\t\t\t) : null}\n\t\t\t\t\t<div className=\"mt-10 flex gap-4\">\n\t\t\t\t\t\t{isLoggedInUser ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tMy notes\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t\t<Link to=\"/settings/profile\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t\tEdit profile\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Button asChild>\n\t\t\t\t\t\t\t\t<Link to=\"notes\" prefetch=\"intent\">\n\t\t\t\t\t\t\t\t\t{userDisplayName}'s notes\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport const meta: Route.MetaFunction = ({ data, params }) => {\n\tconst displayName = data?.user.name ?? params.username\n\treturn [\n\t\t{ title: `${displayName} | Epic Notes` },\n\t\t{\n\t\t\tname: 'description',\n\t\t\tcontent: `Profile of ${displayName} on Epic Notes`,\n\t\t},\n\t]\n}\n\nexport function ErrorBoundary() {\n\treturn (\n\t\t<GeneralErrorBoundary\n\t\t\tstatusHandlers={{\n\t\t\t\t404: ({ params }) => (\n\t\t\t\t\t<p>No user with the username \"{params.username}\" exists</p>\n\t\t\t\t),\n\t\t\t}}\n\t\t/>\n\t)\n}\n"],"names":["$username","_UNSAFE_withComponentProps","data","useLoaderData","user","userDisplayName","name","username","loggedInUser","useOptionalUser","isLoggedInUser","id","jsxs","className","children","jsx","Spacer","size","Img","src","getUserImgSrc","image","objectKey","alt","width","height","userJoinedDisplay","Form","action","method","Button","type","variant","Icon","Fragment","asChild","Link","to","prefetch","meta","params","displayName","title","content","ErrorBoundary","_UNSAFE_withErrorBoundaryProps","GeneralErrorBoundary","statusHandlers"],"mappings":"iZAoCA,MAAAA,EAAAC,EAAA,UAAuC,CACtC,MAAMC,EAAOC,EAAA,EACPC,EAAOF,EAAKE,KACZC,EAAkBD,EAAKE,MAAQF,EAAKG,SACpCC,EAAeC,EAAA,EACfC,EAAiBN,EAAKO,KAAOH,GAAcG,GAEjD,OACCC,EAAAA,KAAC,MAAA,CAAIC,UAAU,kEACdC,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAOC,KAAK,KAAA,CAAM,EAEnBL,EAAAA,KAAC,MAAA,CAAIC,UAAU,iEACdC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAIF,UAAU,gBACdC,SAAAC,EAAAA,IAAC,MAAA,CAAIF,UAAU,mBACdC,SAAAC,EAAAA,IAAC,MAAA,CAAIF,UAAU,WACdC,SAAAC,EAAAA,IAACG,EAAA,CACAC,IAAKC,EAAclB,EAAKE,KAAKiB,OAAOC,SAAS,EAC7CC,IAAKlB,EACLQ,UAAU,oCACVW,MAAO,IACPC,OAAQ,IACT,EACD,EACD,CAAA,CACD,EAEAV,EAAAA,IAACC,EAAA,CAAOC,KAAK,IAAA,CAAK,EAElBL,EAAAA,KAAC,MAAA,CAAIC,UAAU,6BACdC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAIF,UAAU,mDACdC,SAAAC,EAAAA,IAAC,MAAGF,UAAU,sBAAuBC,WAAgB,CAAA,CACtD,EACAF,EAAAA,KAAC,IAAA,CAAEC,UAAU,yCAAyCC,SAAA,CAAA,UAC7CZ,EAAKwB,iBAAA,EACd,EACChB,EACAK,EAAAA,IAACY,EAAA,CAAKC,OAAO,UAAUC,OAAO,OAAOhB,UAAU,OAC9CC,SAAAC,EAAAA,IAACe,EAAA,CAAOC,KAAK,SAASC,QAAQ,OAAOf,KAAK,OACzCH,SAAAC,EAAAA,IAACkB,EAAA,CAAK3B,KAAK,OAAOO,UAAU,6BAA6BC,SAAA,SAEzD,EACD,EACD,EACG,KACJC,EAAAA,IAAC,MAAA,CAAIF,UAAU,mBACbC,WACAF,EAAAA,KAAAsB,WAAA,CACCpB,SAAA,CAAAC,EAAAA,IAACe,EAAA,CAAOK,QAAO,GACdrB,SAAAC,EAAAA,IAACqB,EAAA,CAAKC,GAAG,QAAQC,SAAS,SAASxB,SAAA,WAEnC,CAAA,CACD,EACAC,EAAAA,IAACe,EAAA,CAAOK,QAAO,GACdrB,SAAAC,EAAAA,IAACqB,EAAA,CAAKC,GAAG,oBAAoBC,SAAS,SAASxB,SAAA,eAE/C,CAAA,CACD,CAAA,CAAA,CACD,EAEAC,EAAAA,IAACe,EAAA,CAAOK,QAAO,GACdrB,gBAACsB,EAAA,CAAKC,GAAG,QAAQC,SAAS,SACxBxB,SAAA,CAAAT,EAAgB,UAAA,EAClB,EACD,CAAA,CAEF,CAAA,CAAA,CACD,CAAA,CAAA,CACD,CAAA,CAAA,CACD,CAEF,CAAA,EAEakC,EAA2BA,CAAC,CAAErC,KAAAA,EAAMsC,OAAAA,CAAO,IAAM,CAC7D,MAAMC,EAAcvC,GAAME,KAAKE,MAAQkC,EAAOjC,SAC9C,MAAO,CACN,CAAEmC,MAAO,GAAGD,CAAW,eAAgB,EACvC,CACCnC,KAAM,cACNqC,QAAS,cAAcF,CAAW,gBACnC,CAAA,CAEF,EAEOG,EAAAC,EAAA,UAAyB,CAC/B,OACC9B,EAAAA,IAAC+B,EAAA,CACAC,eAAgB,CACf,IAAK,CAAC,CAAEP,OAAAA,CAAO,WACb,IAAA,CAAE1B,SAAA,CAAA,8BAA4B0B,EAAOjC,SAAS,UAAA,EAAQ,CAEzD,CAAA,CACD,CAEF,CAAA"}