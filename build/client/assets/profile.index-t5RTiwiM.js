import{w as p,j as e,L as a,d as i}from"./chunk-UH6JLGW7-vC5r3Eub.js";import{I as x,g as f,a as u}from"./misc-CB38qpgG.js";import{F as d,E as j}from"./forms-D7XpjJLD.js";import{B as g}from"./button-BP3wkmPp.js";import{I as r}from"./icon-C3K2m46L.js";import{S as l}from"./status-button-hfmu5Em_.js";import{U as v,N as b}from"./user-validation-CltVSBa4.js";import{u as y,g as P,a as c}from"./helpers-Ch5Ym2hM.js";import{g as w}from"./constraint-cuuFo8uo.js";import{p as S}from"./parse-Bbiqquwr.js";import{o as F}from"./types-kDhgxygl.js";import"./index-Bn1b60ek.js";import"./index-C2xojAqc.js";import"./index-BlK1szso.js";import"./dom--0h4o3Zv.js";import"./tooltip-fkOurSWR.js";const H={getSitemapEntries:()=>null},m=F({name:b.nullable().default(null),username:v}),N="update-profile",C="sign-out-of-sessions",k="delete-data",J=p(function({loaderData:s}){return e.jsxs("div",{className:"flex flex-col gap-12",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative size-52",children:[e.jsx(x,{src:f(s.user.image?.objectKey),alt:s.user.name??s.user.username,className:"h-full w-full rounded-full object-cover",width:832,height:832,isAboveFold:!0}),e.jsx(g,{asChild:!0,variant:"outline",className:"absolute top-3 -right-3 flex size-10 items-center justify-center rounded-full p-0",children:e.jsx(a,{preventScrollReset:!0,to:"photo",title:"Change profile photo","aria-label":"Change profile photo",children:e.jsx(r,{name:"camera",className:"size-4"})})})]})}),e.jsx(I,{loaderData:s}),e.jsx("div",{className:"border-foreground col-span-6 my-6 h-1 border-b-[1.5px]"}),e.jsxs("div",{className:"col-span-full flex flex-col gap-6",children:[e.jsx("div",{children:e.jsx(a,{to:"change-email",children:e.jsxs(r,{name:"envelope-closed",children:["Change email from ",s.user.email]})})}),e.jsx("div",{children:e.jsx(a,{to:"two-factor",children:s.isTwoFactorEnabled?e.jsx(r,{name:"lock-closed",children:"2FA is enabled"}):e.jsx(r,{name:"lock-open-1",children:"Enable 2FA"})})}),e.jsx("div",{children:e.jsx(a,{to:s.hasPassword?"password":"password/create",children:e.jsx(r,{name:"dots-horizontal",children:s.hasPassword?"Change Password":"Create a Password"})})}),e.jsx("div",{children:e.jsx(a,{to:"connections",children:e.jsx(r,{name:"link-2",children:"Manage connections"})})}),e.jsx("div",{children:e.jsx(a,{to:"passkeys",children:e.jsx(r,{name:"passkey",children:"Manage passkeys"})})}),e.jsx("div",{children:e.jsx(a,{reloadDocument:!0,download:"my-epic-notes-data.json",to:"/resources/download-user-data",children:e.jsx(r,{name:"download",children:"Download your data"})})}),e.jsx(A,{loaderData:s}),e.jsx(E,{})]})]})});function I({loaderData:t}){const s=i(),[o,n]=y({id:"edit-profile",constraint:w(m),lastResult:s.data?.result,onValidate({formData:h}){return S(h,{schema:m})},defaultValue:{username:t.user.username,name:t.user.name}});return e.jsxs(s.Form,{method:"POST",...P(o),children:[e.jsxs("div",{className:"grid grid-cols-6 gap-x-10",children:[e.jsx(d,{className:"col-span-3",labelProps:{htmlFor:n.username.id,children:"Username"},inputProps:c(n.username,{type:"text"}),errors:n.username.errors}),e.jsx(d,{className:"col-span-3",labelProps:{htmlFor:n.name.id,children:"Name"},inputProps:c(n.name,{type:"text"}),errors:n.name.errors})]}),e.jsx(j,{errors:o.errors,id:o.errorId}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx(l,{type:"submit",size:"wide",name:"intent",value:N,status:s.state!=="idle"?"pending":o.status??"idle",children:"Save changes"})})]})}function A({loaderData:t}){const s=u(),o=i(),n=t.user._count.sessions-1;return e.jsx("div",{children:n?e.jsx(o.Form,{method:"POST",children:e.jsx(l,{...s.getButtonProps({type:"submit",name:"intent",value:C}),variant:s.doubleCheck?"destructive":"default",status:o.state!=="idle"?"pending":o.data?.status??"idle",children:e.jsx(r,{name:"avatar",children:s.doubleCheck?"Are you sure?":`Sign out of ${n} other sessions`})})}):e.jsx(r,{name:"avatar",children:"This is your only session"})})}function E(){const t=u(),s=i();return e.jsx("div",{children:e.jsx(s.Form,{method:"POST",children:e.jsx(l,{...t.getButtonProps({type:"submit",name:"intent",value:k}),variant:t.doubleCheck?"destructive":"default",status:s.state!=="idle"?"pending":"idle",children:e.jsx(r,{name:"trash",children:t.doubleCheck?"Are you sure?":"Delete all your data"})})})})}export{J as default,H as handle};
//# sourceMappingURL=profile.index-t5RTiwiM.js.map
