{"version":3,"file":"notes-DXOrRz0h.js","sources":["../../../app/routes/users+/$username_+/notes.tsx"],"sourcesContent":["import { invariantResponse } from '@epic-web/invariant'\nimport { Img } from 'openimg/react'\nimport { Link, NavLink, Outlet } from 'react-router'\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx'\nimport { Icon } from '#app/components/ui/icon.tsx'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { cn, getUserImgSrc } from '#app/utils/misc.tsx'\nimport { useOptionalUser } from '#app/utils/user.ts'\nimport { type Route } from './+types/notes.ts'\n\nexport async function loader({ params }: Route.LoaderArgs) {\n\tconst owner = await prisma.user.findFirst({\n\t\tselect: {\n\t\t\tid: true,\n\t\t\tname: true,\n\t\t\tusername: true,\n\t\t\timage: { select: { objectKey: true } },\n\t\t\tnotes: { select: { id: true, title: true } },\n\t\t},\n\t\twhere: { username: params.username },\n\t})\n\n\tinvariantResponse(owner, 'Owner not found', { status: 404 })\n\n\treturn { owner }\n}\n\nexport default function NotesRoute({ loaderData }: Route.ComponentProps) {\n\tconst user = useOptionalUser()\n\tconst isOwner = user?.id === loaderData.owner.id\n\tconst ownerDisplayName = loaderData.owner.name ?? loaderData.owner.username\n\tconst navLinkDefaultClassName =\n\t\t'line-clamp-2 block rounded-l-full py-2 pl-8 pr-6 text-base lg:text-xl'\n\treturn (\n\t\t<main className=\"container flex min-h-[400px] flex-1 px-0 pb-12 md:px-8\">\n\t\t\t<div className=\"bg-muted grid w-full grid-cols-4 pl-2 md:container md:rounded-3xl md:pr-0\">\n\t\t\t\t<div className=\"relative col-span-1\">\n\t\t\t\t\t<div className=\"absolute inset-0 flex flex-col\">\n\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\tto={`/users/${loaderData.owner.username}`}\n\t\t\t\t\t\t\tclassName=\"bg-muted flex flex-col items-center justify-center gap-2 pt-12 pr-4 pb-4 pl-8 xl:flex-row xl:justify-start xl:gap-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Img\n\t\t\t\t\t\t\t\tsrc={getUserImgSrc(loaderData.owner.image?.objectKey)}\n\t\t\t\t\t\t\t\talt={ownerDisplayName}\n\t\t\t\t\t\t\t\tclassName=\"size-16 rounded-full object-cover xl:size-24\"\n\t\t\t\t\t\t\t\twidth={256}\n\t\t\t\t\t\t\t\theight={256}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<h1 className=\"text-center text-base font-bold md:text-lg lg:text-left lg:text-2xl\">\n\t\t\t\t\t\t\t\t{ownerDisplayName}'s Notes\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t<ul className=\"overflow-x-hidden overflow-y-auto pb-12\">\n\t\t\t\t\t\t\t{isOwner ? (\n\t\t\t\t\t\t\t\t<li className=\"p-1 pr-0\">\n\t\t\t\t\t\t\t\t\t<NavLink\n\t\t\t\t\t\t\t\t\t\tto=\"new\"\n\t\t\t\t\t\t\t\t\t\tclassName={({ isActive }) =>\n\t\t\t\t\t\t\t\t\t\t\tcn(navLinkDefaultClassName, isActive && 'bg-accent')\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Icon name=\"plus\">New Note</Icon>\n\t\t\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t{loaderData.owner.notes.map((note) => (\n\t\t\t\t\t\t\t\t<li key={note.id} className=\"p-1 pr-0\">\n\t\t\t\t\t\t\t\t\t<NavLink\n\t\t\t\t\t\t\t\t\t\tto={note.id}\n\t\t\t\t\t\t\t\t\t\tpreventScrollReset\n\t\t\t\t\t\t\t\t\t\tprefetch=\"intent\"\n\t\t\t\t\t\t\t\t\t\tclassName={({ isActive }) =>\n\t\t\t\t\t\t\t\t\t\t\tcn(navLinkDefaultClassName, isActive && 'bg-accent')\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{note.title}\n\t\t\t\t\t\t\t\t\t</NavLink>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"bg-accent relative col-span-3 md:rounded-r-3xl\">\n\t\t\t\t\t<Outlet />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</main>\n\t)\n}\n\nexport function ErrorBoundary() {\n\treturn (\n\t\t<GeneralErrorBoundary\n\t\t\tstatusHandlers={{\n\t\t\t\t404: ({ params }) => (\n\t\t\t\t\t<p>No user with the username \"{params.username}\" exists</p>\n\t\t\t\t),\n\t\t\t}}\n\t\t/>\n\t)\n}\n"],"names":["notes","_UNSAFE_withComponentProps","loaderData","isOwner","useOptionalUser","id","owner","ownerDisplayName","name","username","navLinkDefaultClassName","className","children","jsxs","jsx","Link","to","Img","src","getUserImgSrc","image","objectKey","alt","width","height","NavLink","isActive","cn","Icon","map","note","preventScrollReset","prefetch","title","Outlet","ErrorBoundary","_UNSAFE_withErrorBoundaryProps","GeneralErrorBoundary","statusHandlers","params"],"mappings":"0SA2BA,MAAAA,EAAAC,EAAA,SAAmC,CAAEC,WAAAA,CAAW,EAAyB,CAExE,MAAMC,EADOC,EAAA,GACSC,KAAOH,EAAWI,MAAMD,GACxCE,EAAmBL,EAAWI,MAAME,MAAQN,EAAWI,MAAMG,SAC7DC,EACL,wEACD,aACE,OAAA,CAAKC,UAAU,yDACfC,SAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,4EACdC,SAAA,CAAAE,EAAAA,IAAC,OAAIH,UAAU,sBACdC,SAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,iCACdC,SAAA,CAAAC,EAAAA,KAACE,EAAA,CACAC,GAAI,UAAUd,EAAWI,MAAMG,QAAQ,GACvCE,UAAU,sHAEVC,SAAA,CAAAE,EAAAA,IAACG,EAAA,CACAC,IAAKC,EAAcjB,EAAWI,MAAMc,OAAOC,SAAS,EACpDC,IAAKf,EACLI,UAAU,+CACVY,MAAO,IACPC,OAAQ,GAAA,CACT,EACAX,EAAAA,KAAC,KAAA,CAAGF,UAAU,sEACZC,SAAA,CAAAL,EAAiB,UAAA,CAAA,CACnB,CAAA,CAAA,CACD,EACAM,EAAAA,KAAC,KAAA,CAAGF,UAAU,0CACZC,SAAA,CAAAT,EACAW,EAAAA,IAAC,KAAA,CAAGH,UAAU,WACbC,SAAAE,EAAAA,IAACW,EAAA,CACAT,GAAG,MACHL,UAAWA,CAAC,CAAEe,SAAAA,KACbC,EAAGjB,EAAyBgB,GAAY,WAAW,EAGpDd,SAAAE,EAAAA,IAACc,EAAA,CAAKpB,KAAK,OAAOI,SAAA,WAAQ,EAC3B,EACD,EACG,KACHV,EAAWI,MAAMN,MAAM6B,IAAKC,GAC5BhB,EAAAA,IAAC,KAAA,CAAiBH,UAAU,WAC3BC,SAAAE,EAAAA,IAACW,EAAA,CACAT,GAAIc,EAAKzB,GACT0B,mBAAkB,GAClBC,SAAS,SACTrB,UAAWA,CAAC,CAAEe,SAAAA,KACbC,EAAGjB,EAAyBgB,GAAY,WAAW,EAGnDd,SAAAkB,EAAKG,MACP,CAAA,EAVQH,EAAKzB,EAWd,CACA,CAAA,CAAA,CACF,CAAA,EACD,CAAA,CACD,QACC,MAAA,CAAIM,UAAU,iDACdC,SAAAE,EAAAA,IAACoB,IAAO,CAAA,CACT,CAAA,EACD,CAAA,CACD,CAEF,CAAA,EAEOC,EAAAC,EAAA,UAAyB,CAC/B,OACCtB,EAAAA,IAACuB,EAAA,CACAC,eAAgB,CACf,IAAK,CAAC,CAAEC,OAAAA,CAAO,WACb,IAAA,CAAE3B,SAAA,CAAA,8BAA4B2B,EAAO9B,SAAS,UAAA,EAAQ,CAEzD,CAAA,CACD,CAEF,CAAA"}