{"version":3,"file":"index-CDt9h6V2.js","sources":["../../../app/routes/users+/index.tsx"],"sourcesContent":["import { searchUsers } from '@prisma/client/sql'\nimport { Img } from 'openimg/react'\nimport { redirect, Link } from 'react-router'\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx'\nimport { ErrorList } from '#app/components/forms.tsx'\nimport { SearchBar } from '#app/components/search-bar.tsx'\nimport { prisma } from '#app/utils/db.server.ts'\nimport { cn, getUserImgSrc, useDelayedIsPending } from '#app/utils/misc.tsx'\nimport { type Route } from './+types/index.ts'\n\nexport async function loader({ request }: Route.LoaderArgs) {\n\tconst searchTerm = new URL(request.url).searchParams.get('search')\n\tif (searchTerm === '') {\n\t\treturn redirect('/users')\n\t}\n\n\tconst like = `%${searchTerm ?? ''}%`\n\tconst users = await prisma.$queryRawTyped(searchUsers(like))\n\treturn { status: 'idle', users } as const\n}\n\nexport default function UsersRoute({ loaderData }: Route.ComponentProps) {\n\tconst isPending = useDelayedIsPending({\n\t\tformMethod: 'GET',\n\t\tformAction: '/users',\n\t})\n\n\treturn (\n\t\t<div className=\"container mt-36 mb-48 flex flex-col items-center justify-center gap-6\">\n\t\t\t<h1 className=\"text-h1\">Epic Notes Users</h1>\n\t\t\t<div className=\"w-full max-w-[700px]\">\n\t\t\t\t<SearchBar status={loaderData.status} autoFocus autoSubmit />\n\t\t\t</div>\n\t\t\t<main>\n\t\t\t\t{loaderData.status === 'idle' ? (\n\t\t\t\t\tloaderData.users.length ? (\n\t\t\t\t\t\t<ul\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t'flex w-full flex-wrap items-center justify-center gap-4 delay-200',\n\t\t\t\t\t\t\t\t{ 'opacity-50': isPending },\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{loaderData.users.map((user) => (\n\t\t\t\t\t\t\t\t<li key={user.id}>\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\tto={user.username}\n\t\t\t\t\t\t\t\t\t\tclassName=\"bg-muted flex h-36 w-44 flex-col items-center justify-center rounded-lg px-5 py-3\"\n\t\t\t\t\t\t\t\t\t\taria-label={`${user.name || user.username} profile`}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Img\n\t\t\t\t\t\t\t\t\t\t\talt={user.name ?? user.username}\n\t\t\t\t\t\t\t\t\t\t\tsrc={getUserImgSrc(user.imageObjectKey)}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"size-16 rounded-full\"\n\t\t\t\t\t\t\t\t\t\t\twidth={256}\n\t\t\t\t\t\t\t\t\t\t\theight={256}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{user.name ? (\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-body-md w-full overflow-hidden text-center text-ellipsis whitespace-nowrap\">\n\t\t\t\t\t\t\t\t\t\t\t\t{user.name}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-body-sm text-muted-foreground w-full overflow-hidden text-center text-ellipsis\">\n\t\t\t\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<p>No users found</p>\n\t\t\t\t\t)\n\t\t\t\t) : loaderData.status === 'error' ? (\n\t\t\t\t\t<ErrorList errors={['There was an error parsing the results']} />\n\t\t\t\t) : null}\n\t\t\t</main>\n\t\t</div>\n\t)\n}\n\nexport function ErrorBoundary() {\n\treturn <GeneralErrorBoundary />\n}\n"],"names":["index","_UNSAFE_withComponentProps","loaderData","isPending","useDelayedIsPending","formMethod","formAction","jsxs","className","children","jsx","SearchBar","status","autoFocus","autoSubmit","users","length","cn","map","user","Link","to","username","name","Img","alt","src","getUserImgSrc","imageObjectKey","width","height","id","ErrorList","errors","ErrorBoundary","_UNSAFE_withErrorBoundaryProps","GeneralErrorBoundary"],"mappings":"khBAqBA,MAAAA,EAAAC,EAAA,SAAmC,CAAEC,WAAAA,CAAW,EAAyB,CACxE,MAAMC,EAAYC,EAAoB,CACrCC,WAAY,MACZC,WAAY,QACb,CAAC,EAED,OACCC,EAAAA,KAAC,MAAA,CAAIC,UAAU,wEACdC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,UAAUC,SAAA,kBAAA,CAAgB,EACxCC,EAAAA,IAAC,MAAA,CAAIF,UAAU,uBACdC,SAAAC,EAAAA,IAACC,EAAA,CAAUC,OAAQV,EAAWU,OAAQC,UAAS,GAACC,WAAU,GAAC,CAAA,CAC5D,QACC,OAAA,CACCL,SAAAP,EAAWU,SAAW,OACtBV,EAAWa,MAAMC,OAChBN,EAAAA,IAAC,KAAA,CACAF,UAAWS,EACV,oEACA,CAAE,aAAcd,CAAU,CAC3B,EAECM,WAAWM,MAAMG,IAAKC,SACrB,KAAA,CACAV,SAAAF,EAAAA,KAACa,EAAA,CACAC,GAAIF,EAAKG,SACTd,UAAU,oFACV,aAAY,GAAGW,EAAKI,MAAQJ,EAAKG,QAAQ,WAEzCb,SAAA,CAAAC,EAAAA,IAACc,EAAA,CACAC,IAAKN,EAAKI,MAAQJ,EAAKG,SACvBI,IAAKC,EAAcR,EAAKS,cAAc,EACtCpB,UAAU,uBACVqB,MAAO,IACPC,OAAQ,IACT,EACCX,EAAKI,KACLb,EAAAA,IAAC,OAAA,CAAKF,UAAU,kFACdC,SAAAU,EAAKI,KACP,EACG,KACJb,EAAAA,IAAC,OAAA,CAAKF,UAAU,sFACdC,WAAKa,QAAA,CACP,CAAA,EACD,CAAA,EArBQH,EAAKY,EAsBd,CACA,CAAA,CACF,EAEArB,EAAAA,IAAC,IAAA,CAAED,SAAA,gBAAA,CAAc,EAEfP,EAAWU,SAAW,QACzBF,EAAAA,IAACsB,GAAUC,OAAQ,CAAC,wCAAwC,CAAA,CAAG,EAC5D,IAAA,CACL,CAAA,CAAA,CACD,CAEF,CAAA,EAEOC,EAAAC,EAAA,UAAyB,CAC/B,aAAQC,EAAA,EAAqB,CAC9B,CAAA"}